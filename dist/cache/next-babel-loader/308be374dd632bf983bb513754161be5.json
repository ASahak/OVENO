{"ast":null,"code":"import _Object$defineProperty from \"@babel/runtime-corejs2/core-js/object/define-property\";\nimport _Object$defineProperties from \"@babel/runtime-corejs2/core-js/object/define-properties\";\nimport _Object$getOwnPropertyDescriptors from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptors\";\nimport _Object$getOwnPropertyDescriptor from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptor\";\nimport _Object$getOwnPropertySymbols from \"@babel/runtime-corejs2/core-js/object/get-own-property-symbols\";\nimport _Object$keys from \"@babel/runtime-corejs2/core-js/object/keys\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = _Object$keys(object); if (_Object$getOwnPropertySymbols) { var symbols = _Object$getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return _Object$getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (_Object$getOwnPropertyDescriptors) { _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState } from 'react';\nimport Head from 'next/head';\nimport { Container, Row, Col, ModalHeader, ModalBody, Modal } from 'reactstrap';\nimport Categories from 'components/Home/Categories/categories';\nimport RangeSlider from 'components/Shop/RangeSlider';\nimport Products from 'components/Shop/Products';\nimport Icon from 'components/Icons/icon';\nimport FormAdd from 'components/Shop/AddProductForm';\nimport axios from \"lib/axiosEnv\";\nimport Router from \"next/router\";\nimport { connect } from \"react-redux\";\nimport { Bus } from 'lib/EventEmitter';\n\nvar ShopPage = function ShopPage(props) {\n  var _useState = useState({}),\n      categories = _useState[0],\n      setCategories = _useState[1];\n\n  var _useState2 = useState(null),\n      editData = _useState2[0],\n      setEditData = _useState2[1];\n\n  var _useState3 = useState(false),\n      modal = _useState3[0],\n      setModal = _useState3[1];\n\n  var _useState4 = useState(true),\n      resetRangeSlider = _useState4[0],\n      setResetRangeSlider = _useState4[1];\n\n  var _useState5 = useState({}),\n      updatedData = _useState5[0],\n      setUpdatedData = _useState5[1];\n\n  var _useState6 = useState([]),\n      filterByRangeSlider = _useState6[0],\n      setFilterByRangeSlider = _useState6[1];\n\n  var modalOpen =\n  /*#__PURE__*/\n  function () {\n    var _ref = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee(dataEdit) {\n      var _ref2, data, dataCategory;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (dataEdit) {\n                setEditData(dataEdit);\n              }\n\n              _context.next = 3;\n              return axios.get('/api/get/categories');\n\n            case 3:\n              _ref2 = _context.sent;\n              data = _ref2.data;\n\n              if (!data.error) {\n                _context.next = 7;\n                break;\n              }\n\n              throw Error(data.error);\n\n            case 7:\n              dataCategory = {};\n              data.category.forEach(function (cat) {\n                dataCategory[cat.name] = data.subCategory.filter(function (f) {\n                  return f.category === cat.name;\n                }).map(function (a) {\n                  return a.name;\n                });\n              });\n              setCategories(dataCategory);\n              setModal(!modal);\n\n            case 11:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function modalOpen(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var isAdmin = function isAdmin() {\n    return props.isUser && props.isUser.roleType === 'admin';\n  };\n\n  var isUser = function isUser() {\n    return props.isUser && props.isUser.roleType === 'user';\n  };\n\n  var resetFilters = function resetFilters() {\n    Router.push({\n      pathname: '/shop',\n      query: {}\n    }).then(function () {\n      return Bus.dispatch('filterByCategory', {\n        searchReset: true\n      });\n    });\n  };\n\n  var _resetRange = function resetRange() {\n    setResetRangeSlider(false);\n    setResetRangeSlider(true);\n  };\n\n  return __jsx(\"div\", {\n    className: \"jsx-1699274048\"\n  }, __jsx(Head, null, __jsx(\"title\", {\n    className: \"jsx-1699274048\"\n  }, \"Shop\")), __jsx(Container, null, __jsx(Row, null, __jsx(Col, {\n    sm: \"12\",\n    md: \"3\"\n  }, __jsx(\"div\", {\n    style: {\n      position: 'sticky',\n      top: '10px'\n    },\n    className: \"jsx-1699274048\"\n  }, __jsx(Categories, null), __jsx(\"div\", {\n    style: {\n      height: \"40px\"\n    },\n    className: \"jsx-1699274048\"\n  }, resetRangeSlider ? __jsx(RangeSlider, {\n    min: 0,\n    step: 10,\n    max: 10000,\n    resetRange: function resetRange() {\n      return _resetRange();\n    },\n    onChange: function onChange(data) {\n      return setFilterByRangeSlider(data);\n    }\n  }) : ''), __jsx(\"button\", {\n    onClick: function onClick() {\n      return resetFilters();\n    },\n    className: \"jsx-1699274048\" + \" \" + \"reset-btn\"\n  }, \"Reset Filters\"))), __jsx(Col, {\n    sm: \"12\",\n    md: \"9\"\n  }, __jsx(Products, {\n    openEditModal: function openEditModal(data) {\n      return modalOpen(data);\n    },\n    isAdmin: isAdmin(),\n    isUser: isUser(),\n    updatedProduct: updatedData,\n    filterByRange: filterByRangeSlider\n  }))), isAdmin() || isUser() ? __jsx(React.Fragment, null, __jsx(\"span\", {\n    onClick: modalOpen,\n    className: \"jsx-1699274048\" + \" \" + \"add-product-btn\"\n  }, __jsx(Icon, {\n    name: \"add\"\n  })), __jsx(Modal, {\n    isOpen: modal,\n    toggle: modalOpen\n  }, __jsx(ModalHeader, {\n    toggle: modalOpen\n  }, editData && editData._id ? 'Edit Product' : 'Add Product'), __jsx(ModalBody, null, __jsx(FormAdd, {\n    owner: props.isUser._id,\n    isEdit: editData,\n    categories: categories,\n    onClose: function onClose() {\n      return setModal(!modal);\n    },\n    updatedProd: function updatedProd(data, type) {\n      return setUpdatedData(_objectSpread({}, data, {\n        type: type\n      }));\n    }\n  })))) : ''), __jsx(_JSXStyle, {\n    id: \"1699274048\"\n  }, [\".add-product-btn.jsx-1699274048{position:fixed;top:50%;z-index:222;width:30px;right:0;cursor:pointer;}\", \".reset-btn.jsx-1699274048{margin-bottom:20px;border:1px solid transparent;color:#fff;background-color:#191919;width:100%;margin-top:10px;padding:4px;border-radius:3px;font-size:14px;cursor:pointer;}\"]));\n};\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    isUser: state.auth.user\n  };\n};\n\nvar mapDispatchToProps = {};\nexport default connect(mapStateToProps, mapDispatchToProps)(ShopPage);","map":null,"metadata":{},"sourceType":"module"}