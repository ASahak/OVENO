{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nvar __jsx = React.createElement;\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { toast } from 'react-toastify';\nimport styles from './badge.scss';\nimport Icon from 'components/Icons/icon';\nimport Link from 'next/link';\nimport ImageProd from 'components/Shop/elements/imageProduct';\nimport axios from 'lib/axiosEnv';\n\nvar _require = require('utils/auth'),\n    getToken = _require.getToken;\n\nimport { __SET_LOGGED } from 'store/saga';\n\nvar Badge = function Badge(props) {\n  var star = Math.round(props.mainData.rating.reduce(function (acc, item) {\n    acc += item.value;\n    return acc;\n  }, 0) / props.mainData.rating.length);\n\n  var addToCartProd =\n  /*#__PURE__*/\n  function () {\n    var _ref = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var _ref2, data;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n\n              if (props.loggedUser) {\n                _context.next = 3;\n                break;\n              }\n\n              throw Error('Please login before add product!');\n\n            case 3:\n              if (!(props.loggedUser && props.mainData && props.loggedUser.cart.some(function (el) {\n                return el._id === props.mainData._id;\n              }))) {\n                _context.next = 5;\n                break;\n              }\n\n              throw Error('You have this product in your cart already!');\n\n            case 5:\n              _context.next = 7;\n              return axios.post('/api/cart/addToCart', {\n                userId: props.loggedUser._id,\n                id: props.mainData._id,\n                count: 1\n              }, {\n                headers: {\n                  Authorization: getToken('token')\n                }\n              });\n\n            case 7:\n              _ref2 = _context.sent;\n              data = _ref2.data;\n\n              if (!data.error) {\n                _context.next = 11;\n                break;\n              }\n\n              throw Error(data.error);\n\n            case 11:\n              props.loggedUser.cart.push({\n                _id: props.mainData._id,\n                count: 1\n              });\n\n              __SET_LOGGED({\n                user: props.loggedUser\n              }).next();\n\n              toast.dark(data.message, {\n                position: 'top-right',\n                autoClose: 3000,\n                pauseOnHover: false\n              });\n              _context.next = 19;\n              break;\n\n            case 16:\n              _context.prev = 16;\n              _context.t0 = _context[\"catch\"](0);\n              toast.error(_context.t0.response ? _context.t0.response.data : _context.t0.message, {\n                position: 'top-right',\n                autoClose: 3000,\n                pauseOnHover: false\n              });\n\n            case 19:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 16]]);\n    }));\n\n    return function addToCartProd() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  return __jsx(\"div\", {\n    className: styles['slider_item']\n  }, __jsx(\"div\", {\n    className: styles['slider_item-top']\n  }, __jsx(ImageProd, {\n    src: props.mainData.photo\n  }), props.mainData.sale !== 0 && __jsx(\"span\", {\n    className: styles['slider_item-sale_badge']\n  }, \"Sale -\", props.mainData.sale, \"%\"), __jsx(\"div\", {\n    className: styles['slider_item-top_actions-links']\n  }, __jsx(\"span\", {\n    className: \"lnr lnr-cart\",\n    onClick: function onClick() {\n      return addToCartProd();\n    }\n  }), __jsx(Link, {\n    href: '/product/' + props.mainData._id\n  }, __jsx(\"a\", null, __jsx(\"span\", {\n    className: \"lnr lnr-eye\"\n  })))), __jsx(\"h4\", null, props.mainData.name)), __jsx(\"div\", {\n    className: styles['slider_item-bottom']\n  }, __jsx(\"div\", {\n    className: styles['slider_item-bottom_price']\n  }, props.mainData.sale !== 0 ? __jsx(React.Fragment, null, __jsx(\"span\", {\n    className: styles['slider_item-bottom_price_real']\n  }, Math.round(props.mainData.price - props.mainData.price * props.mainData.sale / 100), \"$\"), __jsx(\"span\", {\n    className: styles['slider_item-bottom_price_del']\n  }, props.mainData.price, \"$\")) : __jsx(\"span\", {\n    className: styles['slider_item-bottom_price_real']\n  }, props.mainData.price, \"$\")), __jsx(\"div\", {\n    className: styles['slider_item-bottom_stars']\n  }, Array(5).fill('').map(function (_, index) {\n    if (star > index) {\n      return __jsx(\"span\", {\n        className: \"lnr lnr-star\",\n        key: index\n      });\n    } else {\n      return __jsx(\"span\", {\n        className: \"lnr lnr-star half\",\n        key: index\n      });\n    }\n  }))), !props.noAccessAdmin && (props.isAdmin || props.loggedUser && props.loggedUser._id && props.mainData.owner) ? __jsx(\"div\", {\n    className: styles['user-options']\n  }, __jsx(\"span\", {\n    onClick: function onClick() {\n      return props.editProduct(props.mainData);\n    }\n  }, __jsx(Icon, {\n    name: \"pencil\"\n  })), __jsx(\"span\", {\n    onClick: function onClick() {\n      return props.removeProduct(props.mainData._id);\n    }\n  }, __jsx(Icon, {\n    name: \"delete\"\n  }))) : '');\n};\n\nBadge.propTypes = {\n  mainData: PropTypes.object,\n  editProduct: PropTypes.func,\n  removeProduct: PropTypes.func,\n  isAdmin: PropTypes.bool,\n  isUser: PropTypes.bool,\n  noAccessAdmin: PropTypes.bool\n};\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    loggedUser: state.auth.user\n  };\n};\n\nvar mapDispatchToProps = {};\nexport default connect(mapStateToProps, mapDispatchToProps)(Badge);","map":{"version":3,"sources":["C:/Users/arthu/OneDrive/Desktop/Important/daser/next/OVENO/components/Home/HotSellers/elements/Badge.jsx"],"names":["PropTypes","React","connect","toast","styles","Icon","Link","ImageProd","axios","require","getToken","__SET_LOGGED","Badge","props","star","Math","round","mainData","rating","reduce","acc","item","value","length","addToCartProd","loggedUser","Error","cart","some","el","_id","post","userId","id","count","headers","Authorization","data","error","push","user","next","dark","message","position","autoClose","pauseOnHover","response","photo","sale","name","price","Array","fill","map","_","index","noAccessAdmin","isAdmin","owner","editProduct","removeProduct","propTypes","object","func","bool","isUser","mapStateToProps","state","auth","mapDispatchToProps"],"mappings":"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","sourcesContent":["import PropTypes from 'prop-types';\r\nimport React from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { toast } from 'react-toastify';\r\nimport styles from './badge.scss';\r\nimport Icon from 'components/Icons/icon';\r\nimport Link from 'next/link';\r\nimport ImageProd from 'components/Shop/elements/imageProduct';\r\nimport axios from 'lib/axiosEnv';\r\n\r\nconst {\r\n    getToken\r\n} = require('utils/auth');\r\nimport {\r\n    __SET_LOGGED\r\n} from 'store/saga';\r\n\r\nconst Badge = (props) => {\r\n    const star = Math.round(props.mainData.rating.reduce((acc, item) => {\r\n        acc += item.value;\r\n        return acc\r\n    }, 0) / props.mainData.rating.length);\r\n\r\n\r\n    const addToCartProd = async () => {\r\n        try {\r\n            if (!props.loggedUser) throw Error('Please login before add product!');\r\n            if ((props.loggedUser && props.mainData) && props.loggedUser.cart.some(el => el._id === props.mainData._id)) {\r\n                throw Error('You have this product in your cart already!');\r\n            }\r\n\r\n            const { data } = await axios.post('/api/cart/addToCart', {\r\n                userId: props.loggedUser._id,\r\n                id: props.mainData._id,\r\n                count: 1,\r\n            }, {\r\n                headers: { Authorization: getToken('token') },\r\n            });\r\n            if (data.error) throw Error(data.error);\r\n\r\n            props.loggedUser.cart.push({\r\n                _id: props.mainData._id,\r\n                count: 1,\r\n            });\r\n            __SET_LOGGED({ user: props.loggedUser }).next();\r\n\r\n            toast.dark(data.message, {\r\n                position: 'top-right',\r\n                autoClose: 3000,\r\n                pauseOnHover: false\r\n            });\r\n        } catch (err) {\r\n            toast.error(err.response ? err.response.data : err.message, {\r\n                position: 'top-right',\r\n                autoClose: 3000,\r\n                pauseOnHover: false,\r\n            });\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className={styles['slider_item']}>\r\n            <div className={styles['slider_item-top']}>\r\n                <ImageProd src={props.mainData.photo}/>\r\n                {props.mainData.sale !== 0 &&\r\n                <span className={styles['slider_item-sale_badge']}>Sale -{props.mainData.sale}%</span>}\r\n                <div className={styles['slider_item-top_actions-links']}>\r\n                    <span className=\"lnr lnr-cart\" onClick={() => addToCartProd()}></span>\r\n                    <Link href={'/product/' + props.mainData._id}><a><span className=\"lnr lnr-eye\"></span></a></Link>\r\n                </div>\r\n                <h4>{props.mainData.name}</h4>\r\n            </div>\r\n            <div className={styles['slider_item-bottom']}>\r\n                <div className={styles['slider_item-bottom_price']}>\r\n                    {props.mainData.sale !== 0 ? <>\r\n                        <span\r\n                            className={styles['slider_item-bottom_price_real']}>{Math.round(props.mainData.price - (props.mainData.price * props.mainData.sale / 100))}$</span>\r\n                        <span className={styles['slider_item-bottom_price_del']}>{props.mainData.price}$</span>\r\n                    </> : <span className={styles['slider_item-bottom_price_real']}>{props.mainData.price}$</span>}\r\n                </div>\r\n                <div className={styles['slider_item-bottom_stars']}>\r\n                    {Array(5).fill('').map((_, index) => {\r\n                        if (star > index) {\r\n                            return (<span className=\"lnr lnr-star\" key={index}></span>)\r\n                        } else {\r\n                            return (<span className=\"lnr lnr-star half\" key={index}></span>)\r\n                        }\r\n\r\n                    })}\r\n                </div>\r\n            </div>\r\n            {!props.noAccessAdmin && (props.isAdmin || (props.loggedUser && props.loggedUser._id && props.mainData.owner)) ?\r\n                <div className={styles['user-options']}>\r\n                <span onClick={() => props.editProduct(props.mainData)}>\r\n                    <Icon name=\"pencil\"/>\r\n                </span>\r\n                    <span onClick={() => props.removeProduct(props.mainData._id)}>\r\n                    <Icon name=\"delete\"/>\r\n                </span>\r\n                </div>\r\n                : ''}\r\n        </div>\r\n    )\r\n};\r\n\r\nBadge.propTypes = {\r\n    mainData: PropTypes.object,\r\n    editProduct: PropTypes.func,\r\n    removeProduct: PropTypes.func,\r\n    isAdmin: PropTypes.bool,\r\n    isUser: PropTypes.bool,\r\n    noAccessAdmin: PropTypes.bool,\r\n};\r\nconst mapStateToProps = state => ({\r\n    loggedUser: state.auth.user\r\n});\r\nconst mapDispatchToProps = {};\r\nexport default connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(Badge);\r\n"]},"metadata":{},"sourceType":"module"}