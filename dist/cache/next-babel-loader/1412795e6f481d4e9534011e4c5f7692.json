{"ast":null,"code":"import _Reflect$construct from \"@babel/runtime-corejs2/core-js/reflect/construct\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar __jsx = React.createElement;\n\nfunction _createSuper(Derived) {\n  function isNativeReflectConstruct() {\n    if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n    if (_Reflect$construct.sham) return false;\n    if (typeof Proxy === \"function\") return true;\n\n    try {\n      Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  return function () {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (isNativeReflectConstruct()) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nimport React, { createRef, useState, useEffect } from 'react';\nimport classes from './bestSellers.scss';\nimport Link from 'next/link';\nimport axios from \"lib/axiosEnv\";\nimport ImageProd from \"components/Shop/elements/imageProduct\";\nvar _intervalIndex = 0;\nvar _boolDir = false;\n\nvar Seller = function Seller(props) {\n  var _useState = useState(_intervalIndex),\n      count = _useState[0],\n      setCount = _useState[1];\n\n  useEffect(function () {\n    if (props.playPause) {\n      var id = setInterval(function () {\n        if (!_boolDir) {\n          setCount(count += 1);\n          _intervalIndex = count;\n\n          if (count >= props.sellerCount - props.wrapCount) {\n            _boolDir = true;\n          }\n        } else {\n          setCount(count--);\n          _intervalIndex = count;\n\n          if (count <= 0) {\n            _boolDir = false;\n          }\n        }\n\n        props.refParent.current.style.transform = 'translateY(' + -(count * props.allow / props.wrapCount) + 'px)';\n      }, 3000);\n      return function () {\n        return clearInterval(id);\n      };\n    }\n  }, [props.playPause]);\n\n  var _everySeller = props.products.map(function (item, index) {\n    return __jsx(\"div\", {\n      className: classes['seller-item'],\n      key: index,\n      style: {\n        'height': props.heightRef + 'px'\n      }\n    }, __jsx(ImageProd, {\n      src: item.photo\n    }), __jsx(\"div\", {\n      className: classes['seller-item-info']\n    }, __jsx(\"a\", {\n      href: /product/ + item._id\n    }, item.name), item.sale ? __jsx(\"del\", null, item.price.toFixed(2), \" $\") : '', item.sale ? __jsx(\"span\", {\n      className: classes['seller-item-info-sale-price']\n    }, (item.price - Math.round(item.price * item.sale / 100)).toFixed(2), \" $\") : '', !item.sale ? __jsx(\"span\", {\n      className: classes['seller-item-info-sale-price']\n    }, item.price.toFixed(2), \" $\") : ''));\n  });\n\n  return _everySeller;\n};\n\nvar BestSellers =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(BestSellers, _React$Component);\n\n  var _super = _createSuper(BestSellers);\n\n  function BestSellers() {\n    var _this;\n\n    _classCallCheck(this, BestSellers);\n\n    _this = _super.call(this);\n\n    _defineProperty(_assertThisInitialized(_this), \"componentDidMount\",\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var _ref2, data, _height;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return axios.get('/api/products/getBestSellers', {\n                params: {\n                  count: 5\n                }\n              });\n\n            case 2:\n              _ref2 = _context.sent;\n              data = _ref2.data;\n              if (data.error) console.error(data.error);else {\n                _this.setState({\n                  sellers: data.sellers\n                });\n              }\n\n              if (_this.bestSellerRef.current) {\n                _height = 0;\n                new Array(_this.state.sellers.length).fill('').forEach(function (_, index) {\n                  if (index <= _this.state.sellers.length - _this.state.wrapCountSeller) {\n                    _height += _this.state.badgeHeight;\n                  }\n                });\n\n                _this.setState({\n                  height: _height,\n                  sellerLength: _this.state.sellers.length\n                });\n              }\n\n            case 6:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    })));\n\n    _this.state = {\n      playClass: true,\n      activeIndex: 0,\n      height: 0,\n      sellerLength: 0,\n      badgeHeight: 111,\n      wrapCountSeller: 3,\n      sellers: []\n    };\n    _this.bestSellerRef = React.createRef();\n    return _this;\n  }\n\n  _createClass(BestSellers, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return __jsx(\"div\", {\n        className: classes['best-sellers-wrapper']\n      }, __jsx(\"div\", {\n        className: classes['best-sellers-wrapper-head']\n      }, __jsx(\"h4\", null, \"BestSeller\"), __jsx(\"p\", null, __jsx(\"span\", {\n        className: \"lnr-play-pause \".concat(this.state.playClass ? 'paused' : ''),\n        onClick: function onClick() {\n          return _this2.setState({\n            playClass: !_this2.state.playClass,\n            direction: ''\n          });\n        }\n      }))), __jsx(\"div\", {\n        className: classes['best-sellers-wrapper-content'],\n        style: {\n          height: this.state.height + 'px'\n        }\n      }, __jsx(\"div\", {\n        ref: this.bestSellerRef,\n        className: classes['parent-scrolling']\n      }, this.state.height > 0 && __jsx(Seller, {\n        sellerCount: this.state.sellerLength,\n        wrapCount: this.state.wrapCountSeller,\n        products: this.state.sellers,\n        refParent: this.bestSellerRef,\n        actIndex: this.state.activeIndex,\n        direction: this.state.direction,\n        allow: this.state.height,\n        heightRef: this.state.badgeHeight,\n        playPause: this.state.playClass\n      }))));\n    }\n  }]);\n\n  return BestSellers;\n}(React.Component);\n\nexport default BestSellers;","map":null,"metadata":{},"sourceType":"module"}