{"ast":null,"code":"var __jsx = React.createElement;\nimport React, { useRef, useState } from 'react';\nimport Head from 'next/head';\nimport Icon from \"components/Icons/icon\";\nimport DumpLayout from \"components/shared/Layouts/dump\";\nimport UI_ELEMENTS from \"components/shared/UI\";\nimport Link from 'next/link';\nimport { useForm } from 'react-hook-form';\nimport { FULL_NAME_VALIDATOR, EMAIL_VALIDATOR, PASSWORD_VALIDATOR } from 'utils';\nimport axios from \"lib/axiosEnv\";\nimport { toast } from 'react-toastify';\n\nconst {\n  setToken\n} = require('../utils/auth');\n\nconst generateAlert = (reset, setLoadingRegister, typeAlert, message, _timeout) => {\n  reset();\n  setLoadingRegister(false);\n  toast[typeAlert](message, {\n    position: \"top-right\",\n    autoClose: _timeout,\n    pauseOnHover: false\n  });\n};\n\nfunction RegisterForm() {\n  const _timeout = 3000;\n  const {\n    0: loadingRegister,\n    1: setLoadingRegister\n  } = useState(false);\n  const {\n    register,\n    handleSubmit,\n    watch,\n    errors,\n    reset\n  } = useForm({\n    mode: 'onBlur'\n  });\n\n  const onSubmit = async dataForm => {\n    setLoadingRegister(true);\n    const timeStart = new Date().getTime();\n\n    try {\n      dataForm.avatar = 'user.png'; // set default user avatar\n\n      const {\n        data\n      } = await axios.post('/api/create/user', dataForm);\n      if (data.error) throw new Error(data.error);\n      setToken(data.token);\n      const timeEnd = new Date().getTime();\n\n      if (timeEnd - timeStart > _timeout) {\n        generateAlert(reset, setLoadingRegister, 'dark', 'User is registered successfully', _timeout);\n        setTimeout(() => {\n          location.href = '/';\n        }, _timeout);\n      } else {\n        setTimeout(() => {\n          generateAlert(reset, setLoadingRegister, 'dark', 'User is registered successfully', _timeout);\n          setTimeout(() => {\n            location.href = '/';\n          }, _timeout);\n        }, _timeout - (timeEnd - timeStart));\n      }\n    } catch (err) {\n      const timeEnd = new Date().getTime();\n\n      if (timeEnd - timeStart > _timeout) {\n        generateAlert(reset, setLoadingRegister, 'error', err.message, _timeout);\n      } else {\n        setTimeout(() => {\n          generateAlert(reset, setLoadingRegister, 'error', err.message, _timeout);\n        }, _timeout - (timeEnd - timeStart));\n      }\n    }\n  };\n\n  const password = useRef({});\n  password.current = watch(\"password\", \"\");\n  return __jsx(\"form\", {\n    className: \"login-form\",\n    onSubmit: handleSubmit(onSubmit)\n  }, __jsx(UI_ELEMENTS.Input, {\n    type: \"text\",\n    name: \"name\",\n    refBind: register(FULL_NAME_VALIDATOR),\n    errors: errors.name && errors.name.message,\n    fullWidth: true,\n    placeholder: \"Name\",\n    size: \"md\"\n  }), __jsx(UI_ELEMENTS.Input, {\n    type: \"email\",\n    name: \"email\",\n    refBind: register(EMAIL_VALIDATOR),\n    errors: errors.email && errors.email.message,\n    fullWidth: true,\n    placeholder: \"Email ID\",\n    size: \"md\"\n  }), __jsx(UI_ELEMENTS.Input, {\n    refBind: register(PASSWORD_VALIDATOR),\n    errors: errors.password && errors.password.message || errors.password && errors.password.type === 'containsDigit' && 'Use 1 ore more numbers' || errors.password && errors.password.type === 'containsUppercase' && 'Use upper and lower case characters',\n    name: \"password\",\n    type: \"password\",\n    fullWidth: true,\n    placeholder: \"Password\",\n    size: \"md\"\n  }), __jsx(UI_ELEMENTS.Input, {\n    refBind: register({\n      validate: value => value === password.current || \"The passwords do not match\"\n    }),\n    errors: errors.password_repeat && errors.password_repeat.message,\n    name: \"password_repeat\",\n    type: \"password\",\n    fullWidth: true,\n    placeholder: \"Confirm Password\",\n    size: \"md\"\n  }), __jsx(UI_ELEMENTS.Button, {\n    icon: loadingRegister ? {\n      dir: 'right',\n      element: 'loading'\n    } : {},\n    type: \"submit\",\n    text: \"Register\",\n    width: 190,\n    size: \"md\"\n  }), __jsx(Link, {\n    href: \"/login\",\n    prefetch: false\n  }, __jsx(\"a\", {\n    className: \"link-to-reset\"\n  }, \"I have an account already. Go to login\")));\n}\n\nclass Register extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {};\n  }\n\n  render() {\n    return __jsx(\"div\", {\n      className: \"container\"\n    }, __jsx(Head, null, __jsx(\"title\", null, \"Register\")), __jsx(\"main\", null, __jsx(\"div\", {\n      className: \"register-form-container\"\n    }, __jsx(\"div\", {\n      className: \"form-icon\"\n    }, __jsx(Icon, {\n      name: \"user\"\n    })), __jsx(\"h4\", {\n      className: \"title-form\"\n    }, \"Member Register\"), __jsx(RegisterForm, null))));\n  }\n\n}\n\nRegister.Layout = DumpLayout;\nexport default Register;","map":null,"metadata":{},"sourceType":"module"}