{"ast":null,"code":"var __jsx = React.createElement;\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { toast } from 'react-toastify';\nimport styles from './badge.scss';\nimport Icon from 'components/Icons/icon';\nimport Link from 'next/link';\nimport ImageProd from 'components/Shop/elements/imageProduct';\nimport axios from 'lib/axiosEnv';\n\nconst {\n  getToken\n} = require('utils/auth');\n\nimport { __SET_LOGGED } from 'store/saga';\n\nconst Badge = props => {\n  const star = Math.round(props.mainData.rating.reduce((acc, item) => {\n    acc += item.value;\n    return acc;\n  }, 0) / props.mainData.rating.length);\n\n  const addToCartProd = async () => {\n    try {\n      if (!props.loggedUser) throw Error('Please login before add product!');\n\n      if (props.loggedUser && props.mainData && props.loggedUser.cart.some(el => el._id === props.mainData._id)) {\n        throw Error('You have this product in your cart already!');\n      }\n\n      const {\n        data\n      } = await axios.post('/api/cart/addToCart', {\n        userId: props.loggedUser._id,\n        id: props.mainData._id,\n        count: 1\n      }, {\n        headers: {\n          Authorization: getToken('token')\n        }\n      });\n      if (data.error) throw Error(data.error);\n      props.loggedUser.cart.push({\n        _id: props.mainData._id,\n        count: 1\n      });\n\n      __SET_LOGGED({\n        user: props.loggedUser\n      }).next();\n\n      toast.dark(data.message, {\n        position: 'top-right',\n        autoClose: 3000,\n        pauseOnHover: false\n      });\n    } catch (err) {\n      toast.error(err.response ? err.response.data : err.message, {\n        position: 'top-right',\n        autoClose: 3000,\n        pauseOnHover: false\n      });\n    }\n  };\n\n  return __jsx(\"div\", {\n    className: styles['slider_item']\n  }, __jsx(\"div\", {\n    className: styles['slider_item-top']\n  }, __jsx(ImageProd, {\n    src: props.mainData.photo\n  }), props.mainData.sale !== 0 && __jsx(\"span\", {\n    className: styles['slider_item-sale_badge']\n  }, \"Sale -\", props.mainData.sale, \"%\"), __jsx(\"div\", {\n    className: styles['slider_item-top_actions-links']\n  }, __jsx(\"span\", {\n    className: \"lnr lnr-cart\",\n    onClick: () => addToCartProd()\n  }), __jsx(Link, {\n    href: '/product/' + props.mainData._id\n  }, __jsx(\"a\", null, __jsx(\"span\", {\n    className: \"lnr lnr-eye\"\n  })))), __jsx(\"h4\", null, props.mainData.name)), __jsx(\"div\", {\n    className: styles['slider_item-bottom']\n  }, __jsx(\"div\", {\n    className: styles['slider_item-bottom_price']\n  }, props.mainData.sale !== 0 ? __jsx(React.Fragment, null, __jsx(\"span\", {\n    className: styles['slider_item-bottom_price_real']\n  }, Math.round(props.mainData.price - props.mainData.price * props.mainData.sale / 100), \"$\"), __jsx(\"span\", {\n    className: styles['slider_item-bottom_price_del']\n  }, props.mainData.price, \"$\")) : __jsx(\"span\", {\n    className: styles['slider_item-bottom_price_real']\n  }, props.mainData.price, \"$\")), __jsx(\"div\", {\n    className: styles['slider_item-bottom_stars']\n  }, Array(5).fill('').map((_, index) => {\n    if (star > index) {\n      return __jsx(\"span\", {\n        className: \"lnr lnr-star\",\n        key: index\n      });\n    } else {\n      return __jsx(\"span\", {\n        className: \"lnr lnr-star half\",\n        key: index\n      });\n    }\n  }))), !props.noAccessAdmin && (props.isAdmin || props.loggedUser && props.loggedUser._id && props.mainData.owner) ? __jsx(\"div\", {\n    className: styles['user-options']\n  }, __jsx(\"span\", {\n    onClick: () => props.editProduct(props.mainData)\n  }, __jsx(Icon, {\n    name: \"pencil\"\n  })), __jsx(\"span\", {\n    onClick: () => props.removeProduct(props.mainData._id)\n  }, __jsx(Icon, {\n    name: \"delete\"\n  }))) : '');\n};\n\nBadge.propTypes = {\n  mainData: PropTypes.object,\n  editProduct: PropTypes.func,\n  removeProduct: PropTypes.func,\n  isAdmin: PropTypes.bool,\n  isUser: PropTypes.bool,\n  noAccessAdmin: PropTypes.bool\n};\n\nconst mapStateToProps = state => ({\n  loggedUser: state.auth.user\n});\n\nconst mapDispatchToProps = {};\nexport default connect(mapStateToProps, mapDispatchToProps)(Badge);","map":{"version":3,"sources":["C:/Users/arthu/OneDrive/Desktop/Important/daser/next/OVENO/components/Home/HotSellers/elements/Badge.jsx"],"names":["PropTypes","React","connect","toast","styles","Icon","Link","ImageProd","axios","getToken","require","__SET_LOGGED","Badge","props","star","Math","round","mainData","rating","reduce","acc","item","value","length","addToCartProd","loggedUser","Error","cart","some","el","_id","data","post","userId","id","count","headers","Authorization","error","push","user","next","dark","message","position","autoClose","pauseOnHover","err","response","photo","sale","name","price","Array","fill","map","_","index","noAccessAdmin","isAdmin","owner","editProduct","removeProduct","propTypes","object","func","bool","isUser","mapStateToProps","state","auth","mapDispatchToProps"],"mappings":"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","sourcesContent":["import PropTypes from 'prop-types';\r\nimport React from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { toast } from 'react-toastify';\r\nimport styles from './badge.scss';\r\nimport Icon from 'components/Icons/icon';\r\nimport Link from 'next/link';\r\nimport ImageProd from 'components/Shop/elements/imageProduct';\r\nimport axios from 'lib/axiosEnv';\r\n\r\nconst {\r\n    getToken\r\n} = require('utils/auth');\r\nimport {\r\n    __SET_LOGGED\r\n} from 'store/saga';\r\n\r\nconst Badge = (props) => {\r\n    const star = Math.round(props.mainData.rating.reduce((acc, item) => {\r\n        acc += item.value;\r\n        return acc\r\n    }, 0) / props.mainData.rating.length);\r\n\r\n\r\n    const addToCartProd = async () => {\r\n        try {\r\n            if (!props.loggedUser) throw Error('Please login before add product!');\r\n            if ((props.loggedUser && props.mainData) && props.loggedUser.cart.some(el => el._id === props.mainData._id)) {\r\n                throw Error('You have this product in your cart already!');\r\n            }\r\n\r\n            const { data } = await axios.post('/api/cart/addToCart', {\r\n                userId: props.loggedUser._id,\r\n                id: props.mainData._id,\r\n                count: 1,\r\n            }, {\r\n                headers: { Authorization: getToken('token') },\r\n            });\r\n            if (data.error) throw Error(data.error);\r\n\r\n            props.loggedUser.cart.push({\r\n                _id: props.mainData._id,\r\n                count: 1,\r\n            });\r\n            __SET_LOGGED({ user: props.loggedUser }).next();\r\n\r\n            toast.dark(data.message, {\r\n                position: 'top-right',\r\n                autoClose: 3000,\r\n                pauseOnHover: false\r\n            });\r\n        } catch (err) {\r\n            toast.error(err.response ? err.response.data : err.message, {\r\n                position: 'top-right',\r\n                autoClose: 3000,\r\n                pauseOnHover: false,\r\n            });\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className={styles['slider_item']}>\r\n            <div className={styles['slider_item-top']}>\r\n                <ImageProd src={props.mainData.photo}/>\r\n                {props.mainData.sale !== 0 &&\r\n                <span className={styles['slider_item-sale_badge']}>Sale -{props.mainData.sale}%</span>}\r\n                <div className={styles['slider_item-top_actions-links']}>\r\n                    <span className=\"lnr lnr-cart\" onClick={() => addToCartProd()}></span>\r\n                    <Link href={'/product/' + props.mainData._id}><a><span className=\"lnr lnr-eye\"></span></a></Link>\r\n                </div>\r\n                <h4>{props.mainData.name}</h4>\r\n            </div>\r\n            <div className={styles['slider_item-bottom']}>\r\n                <div className={styles['slider_item-bottom_price']}>\r\n                    {props.mainData.sale !== 0 ? <>\r\n                        <span\r\n                            className={styles['slider_item-bottom_price_real']}>{Math.round(props.mainData.price - (props.mainData.price * props.mainData.sale / 100))}$</span>\r\n                        <span className={styles['slider_item-bottom_price_del']}>{props.mainData.price}$</span>\r\n                    </> : <span className={styles['slider_item-bottom_price_real']}>{props.mainData.price}$</span>}\r\n                </div>\r\n                <div className={styles['slider_item-bottom_stars']}>\r\n                    {Array(5).fill('').map((_, index) => {\r\n                        if (star > index) {\r\n                            return (<span className=\"lnr lnr-star\" key={index}></span>)\r\n                        } else {\r\n                            return (<span className=\"lnr lnr-star half\" key={index}></span>)\r\n                        }\r\n\r\n                    })}\r\n                </div>\r\n            </div>\r\n            {!props.noAccessAdmin && (props.isAdmin || (props.loggedUser && props.loggedUser._id && props.mainData.owner)) ?\r\n                <div className={styles['user-options']}>\r\n                <span onClick={() => props.editProduct(props.mainData)}>\r\n                    <Icon name=\"pencil\"/>\r\n                </span>\r\n                    <span onClick={() => props.removeProduct(props.mainData._id)}>\r\n                    <Icon name=\"delete\"/>\r\n                </span>\r\n                </div>\r\n                : ''}\r\n        </div>\r\n    )\r\n};\r\n\r\nBadge.propTypes = {\r\n    mainData: PropTypes.object,\r\n    editProduct: PropTypes.func,\r\n    removeProduct: PropTypes.func,\r\n    isAdmin: PropTypes.bool,\r\n    isUser: PropTypes.bool,\r\n    noAccessAdmin: PropTypes.bool,\r\n};\r\nconst mapStateToProps = state => ({\r\n    loggedUser: state.auth.user\r\n});\r\nconst mapDispatchToProps = {};\r\nexport default connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(Badge);\r\n"]},"metadata":{},"sourceType":"module"}