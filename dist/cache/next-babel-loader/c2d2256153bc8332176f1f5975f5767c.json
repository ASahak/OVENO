{"ast":null,"code":"import _Object$defineProperty from \"@babel/runtime-corejs2/core-js/object/define-property\";\nimport _Object$defineProperties from \"@babel/runtime-corejs2/core-js/object/define-properties\";\nimport _Object$getOwnPropertyDescriptors from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptors\";\nimport _Object$getOwnPropertyDescriptor from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptor\";\nimport _Object$getOwnPropertySymbols from \"@babel/runtime-corejs2/core-js/object/get-own-property-symbols\";\nimport _Object$keys from \"@babel/runtime-corejs2/core-js/object/keys\";\nimport _Reflect$construct from \"@babel/runtime-corejs2/core-js/reflect/construct\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _toConsumableArray from \"@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = _Object$keys(object); if (_Object$getOwnPropertySymbols) { var symbols = _Object$getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return _Object$getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (_Object$getOwnPropertyDescriptors) { _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createSuper(Derived) {\n  function isNativeReflectConstruct() {\n    if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n    if (_Reflect$construct.sham) return false;\n    if (typeof Proxy === \"function\") return true;\n\n    try {\n      Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  return function () {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (isNativeReflectConstruct()) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nimport React from 'react';\nimport { Container, Row, Col } from 'reactstrap';\nimport classesMiddleWrap from './middleWrap.scss';\nimport Router from 'next/router';\nimport { ModalToggle } from \"utils/common\";\nimport { connect } from \"react-redux\";\nimport axios from \"lib/axiosEnv\";\nimport { Bus } from \"lib/EventEmitter\";\n\nvar _require = require('utils/auth'),\n    getToken = _require.getToken;\n\nvar MiddleWrap =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(MiddleWrap, _React$Component);\n\n  var _super = _createSuper(MiddleWrap);\n\n  function MiddleWrap(props) {\n    var _this;\n\n    _classCallCheck(this, MiddleWrap);\n\n    _this = _super.call(this, props);\n    _this.cartRef = React.createRef();\n    _this._modal = new ModalToggle();\n    _this.state = {\n      dataCart: []\n    };\n    _this.searchRef = React.createRef();\n    Bus.subscribe('filterByCategory', function (reset) {\n      if (reset && reset.searchReset && _this.searchRef.current) {\n        _this.searchRef.current.value = '';\n      }\n    });\n    return _this;\n  }\n\n  _createClass(MiddleWrap, [{\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      Bus.unsubscribe('filterByCategory');\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      if (Router.router.components.hasOwnProperty('/shop')) {\n        setTimeout(function () {\n          var query = _objectSpread({}, Router.query);\n\n          _this2.searchRef.current.value = query.name || '';\n        }, 0);\n      }\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState, snapshot) {\n      var _this3 = this;\n\n      if (prevProps.isUser !== this.props.isUser) {\n        _asyncToGenerator(\n        /*#__PURE__*/\n        _regeneratorRuntime.mark(function _callee() {\n          var _ref2, data;\n\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  _context.next = 2;\n                  return axios.get('/api/cart/getCart', {\n                    headers: {\n                      Authorization: getToken('token')\n                    },\n                    params: {\n                      ids: _toConsumableArray(_this3.props.isUser.cart.map(function (id) {\n                        return id._id;\n                      }))\n                    }\n                  });\n\n                case 2:\n                  _ref2 = _context.sent;\n                  data = _ref2.data;\n\n                  if (!data.error) {\n                    _context.next = 7;\n                    break;\n                  }\n\n                  console.error(data.error);\n                  return _context.abrupt(\"return\");\n\n                case 7:\n                  _this3.setState({\n                    dataCart: function () {\n                      var cart = [];\n\n                      _this3.props.isUser.cart.forEach(function (item) {\n                        var findMatched = data.products.find(function (el) {\n                          return el._id === item._id;\n                        });\n\n                        if (findMatched) {\n                          cart.push({\n                            id: item._id,\n                            name: findMatched.name,\n                            count: item.count,\n                            imgPath: findMatched.photo\n                          });\n                        } else {\n                          // Detect Already Removed Products\n                          cart.push({\n                            removed: true\n                          });\n                        }\n                      });\n\n                      return cart.slice(0, 2);\n                    }()\n                  });\n\n                case 8:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee);\n        }))();\n      }\n    }\n  }, {\n    key: \"__showLangModal\",\n    value: function __showLangModal(ref, hint) {\n      return ref.current && this._modal.showModal(ref.current, false, hint);\n    }\n  }, {\n    key: \"__hideModal\",\n    value: function __hideModal() {\n      this._modal.customHideModal();\n    }\n  }, {\n    key: \"searchByName\",\n    value: function searchByName() {\n      if (this.searchRef.current) {\n        var query = _objectSpread({}, Router.query);\n\n        Router.push({\n          pathname: '/shop',\n          query: _objectSpread({}, query, {\n            name: this.searchRef.current.value\n          })\n        }).then(function () {\n          return Bus.dispatch('filterByCategory');\n        });\n      }\n    }\n  }, {\n    key: \"triggerSearchName\",\n    value: function triggerSearchName(evt) {\n      if (evt.key === 'Enter') {\n        this.searchByName();\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      return __jsx(\"div\", {\n        className: classesMiddleWrap.middle_content_header\n      }, __jsx(Container, null, __jsx(Row, {\n        className: \"align-items-center\"\n      }, __jsx(Col, {\n        xs: \"7\",\n        sm: \"7\",\n        md: \"4\",\n        className: classesMiddleWrap.logo_content\n      }, __jsx(\"a\", {\n        href: \"/\",\n        className: \"d-inline-flex align-items-center justify-content-md-start justify-content-center\"\n      }, __jsx(\"img\", {\n        className: \"mr-2\",\n        src: require('../../../../assets/images/logo.png'),\n        alt: \"\"\n      }), \"VENO\")), __jsx(Col, {\n        xs: \"12\",\n        sm: \"12\",\n        md: \"5\",\n        className: classesMiddleWrap.search_block\n      }, __jsx(\"div\", {\n        id: classesMiddleWrap.main_search\n      }, __jsx(\"div\", {\n        className: classesMiddleWrap.search_wrap\n      }, __jsx(\"input\", {\n        type: \"text\",\n        ref: this.searchRef,\n        onKeyPress: function onKeyPress(e) {\n          return _this4.triggerSearchName(e);\n        },\n        placeholder: \"Search entire store here...\"\n      }), __jsx(\"button\", {\n        type: \"button\",\n        onClick: function onClick() {\n          return _this4.searchByName();\n        }\n      }, __jsx(\"span\", {\n        className: \"lnr lnr-magnifier\"\n      }))))), this.props.isUser ? __jsx(Col, {\n        xs: \"5\",\n        sm: \"5\",\n        md: \"3\",\n        className: classesMiddleWrap.cart_item_parent\n      }, __jsx(\"a\", {\n        className: classesMiddleWrap.cart_wrap,\n        onClick: this.__showLangModal.bind(this, this.cartRef, 'noClose')\n      }, __jsx(\"span\", {\n        className: \"\".concat(classesMiddleWrap.lnr, \" lnr lnr-cart\")\n      }), \"My cart: \", this.props.isUser.cart.length, \" item\", __jsx(\"i\", {\n        className: \"\".concat(classesMiddleWrap.fas, \" fas fa-angle-down\")\n      })), __jsx(ShopCart, {\n        hideModal: this.__hideModal.bind(this),\n        ref: this.cartRef,\n        data: this.state.dataCart\n      })) : '')));\n    }\n  }]);\n\n  return MiddleWrap;\n}(React.Component);\n\nvar ShopCart = React.forwardRef(function (_ref3, ref) {\n  var data = _ref3.data,\n      noHide = _ref3.noHide,\n      hideModal = _ref3.hideModal;\n\n  var _cart = data.map(function (item, index) {\n    return __jsx(\"li\", {\n      key: item.removed ? index : item.id,\n      className: classesMiddleWrap['main-cart-modal-item']\n    }, item.removed ? __jsx(\"span\", null, \"This Item removed\") : __jsx(React.Fragment, null, __jsx(\"span\", null, __jsx(\"img\", {\n      src: item.imgPath,\n      alt: \"no image\"\n    }), __jsx(\"b\", null, item.name)), __jsx(\"div\", null, __jsx(\"span\", null, \"x \", __jsx(\"br\", null), item.count))));\n  });\n\n  return __jsx(\"div\", {\n    className: classesMiddleWrap['main-cart-modal'],\n    ref: ref\n  }, data.length ? __jsx(React.Fragment, null, __jsx(\"ul\", null, _cart), __jsx(\"a\", {\n    href: \"/cart\",\n    className: classesMiddleWrap['view-all-cart-btn'],\n    onClick: hideModal\n  }, \"View All\")) : 'You dont have any added product in your cart yet');\n});\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    isUser: state.auth.user\n  };\n};\n\nvar mapDispatchToProps = {};\nexport default connect(mapStateToProps, mapDispatchToProps)(MiddleWrap);","map":{"version":3,"sources":["C:/Users/arthu/OneDrive/Desktop/Important/daser/next/OVENO/components/shared/header/elements/middleWrap.jsx"],"names":["React","Container","Row","Col","classesMiddleWrap","Router","ModalToggle","connect","axios","Bus","require","getToken","MiddleWrap","props","cartRef","createRef","_modal","state","dataCart","searchRef","subscribe","reset","searchReset","current","value","unsubscribe","router","components","hasOwnProperty","setTimeout","query","name","prevProps","prevState","snapshot","isUser","get","headers","Authorization","params","ids","cart","map","id","_id","data","error","console","setState","forEach","item","findMatched","products","find","el","push","count","imgPath","photo","removed","slice","ref","hint","showModal","customHideModal","pathname","then","dispatch","evt","key","searchByName","middle_content_header","logo_content","search_block","main_search","search_wrap","e","triggerSearchName","cart_item_parent","cart_wrap","__showLangModal","bind","lnr","length","fas","__hideModal","Component","ShopCart","forwardRef","noHide","hideModal","_cart","index","mapStateToProps","auth","user","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React from 'react'\r\nimport {Container, Row, Col} from 'reactstrap'\r\nimport classesMiddleWrap from './middleWrap.scss';\r\nimport Router from 'next/router';\r\nimport {ModalToggle} from \"utils/common\";\r\nimport {connect} from \"react-redux\";\r\nimport axios from \"lib/axiosEnv\";\r\nimport {Bus} from \"lib/EventEmitter\";\r\nconst {\r\n    getToken\r\n} = require('utils/auth');\r\n\r\nclass MiddleWrap extends React.Component {\r\n    constructor (props) {\r\n        super(props);\r\n        this.cartRef = React.createRef();\r\n        this._modal = new ModalToggle();\r\n        this.state = {\r\n            dataCart: []\r\n        };\r\n        this.searchRef = React.createRef();\r\n        Bus.subscribe('filterByCategory', (reset) => {\r\n            if (reset && reset.searchReset && this.searchRef.current) {\r\n                this.searchRef.current.value = ''\r\n            }\r\n        })\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        Bus.unsubscribe('filterByCategory');\r\n    }\r\n\r\n    componentDidMount() {\r\n        if (Router.router.components.hasOwnProperty('/shop')) {\r\n            setTimeout(() => {\r\n                const query = {...Router.query};\r\n                this.searchRef.current.value = query.name || ''\r\n            }, 0)\r\n        }\r\n    }\r\n\r\n    componentDidUpdate(prevProps, prevState, snapshot) {\r\n        if (prevProps.isUser !== this.props.isUser) {\r\n            (async () => {\r\n                const {data} = await axios.get('/api/cart/getCart', {\r\n                    headers: { Authorization: getToken('token')},\r\n                    params: {\r\n                        ids: [...this.props.isUser.cart.map(id => id._id)],\r\n                    }\r\n                });\r\n                if (data.error) {\r\n                    console.error(data.error);\r\n                    return;\r\n                }\r\n                this.setState({\r\n                    dataCart: (() => {\r\n                        const cart = [];\r\n                        this.props.isUser.cart.forEach(item => {\r\n                            const findMatched = data.products.find(el => el._id === item._id);\r\n                            if (findMatched) {\r\n                                cart.push({\r\n                                    id: item._id,\r\n                                    name: findMatched.name,\r\n                                    count: item.count,\r\n                                    imgPath: findMatched.photo,\r\n                                })\r\n                            } else { // Detect Already Removed Products\r\n                                cart.push({\r\n                                    removed: true,\r\n                                })\r\n                            }\r\n                        });\r\n                        return cart.slice(0, 2);\r\n                    })()\r\n                });\r\n            })();\r\n        }\r\n    }\r\n\r\n    __showLangModal (ref, hint) {\r\n        return ref.current && this._modal.showModal(ref.current, false, hint)\r\n    }\r\n    __hideModal () {\r\n        this._modal.customHideModal()\r\n    }\r\n\r\n    searchByName () {\r\n        if (this.searchRef.current) {\r\n            const query = {...Router.query};\r\n            Router.push({\r\n                pathname: '/shop',\r\n                query: { ...query, name: this.searchRef.current.value}\r\n            }).then(() => Bus.dispatch('filterByCategory'))\r\n        }\r\n    }\r\n    triggerSearchName (evt) {\r\n        if (evt.key === 'Enter') {\r\n            this.searchByName();\r\n        }\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className={classesMiddleWrap.middle_content_header}>\r\n                <Container>\r\n                    <Row className=\"align-items-center\">\r\n                        <Col xs=\"7\" sm=\"7\" md=\"4\" className={classesMiddleWrap.logo_content}>\r\n                            <a href=\"/\" className=\"d-inline-flex align-items-center justify-content-md-start justify-content-center\">\r\n                                <img className=\"mr-2\" src={require('../../../../assets/images/logo.png')} alt=\"\" />\r\n                                VENO\r\n                            </a>\r\n                        </Col>\r\n                        <Col xs=\"12\" sm=\"12\" md=\"5\" className={classesMiddleWrap.search_block}>\r\n                            <div id={classesMiddleWrap.main_search}>\r\n                                <div className={classesMiddleWrap.search_wrap}>\r\n                                    <input type=\"text\" ref={this.searchRef} onKeyPress={(e) => this.triggerSearchName(e)} placeholder=\"Search entire store here...\" />\r\n                                    <button type=\"button\" onClick={() => this.searchByName()}>\r\n                                        <span className=\"lnr lnr-magnifier\"></span>\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        </Col>\r\n                        {this.props.isUser ? <Col xs=\"5\" sm=\"5\" md=\"3\" className={classesMiddleWrap.cart_item_parent}>\r\n                            <a className={classesMiddleWrap.cart_wrap} onClick={this.__showLangModal.bind(this, this.cartRef, 'noClose')}>\r\n                                <span className={`${classesMiddleWrap.lnr} lnr lnr-cart`}></span>\r\n                                My cart: {this.props.isUser.cart.length} item\r\n                                <i className={`${classesMiddleWrap.fas} fas fa-angle-down`}></i>\r\n                            </a>\r\n                            <ShopCart hideModal={this.__hideModal.bind(this)} ref={this.cartRef} data={this.state.dataCart} />\r\n                        </Col> : ''}\r\n                    </Row>\r\n                </Container>\r\n            </div>\r\n        );\r\n    }\r\n}\r\nconst ShopCart = React.forwardRef(({data, noHide, hideModal}, ref) => {\r\n    let _cart = data.map((item, index) => <li key={item.removed ? index : item.id} className={classesMiddleWrap['main-cart-modal-item']}>\r\n        {item.removed ? <span>This Item removed</span> :\r\n            <>\r\n                <span>\r\n                    <img src={item.imgPath} alt=\"no image\"/>\r\n                    <b>{item.name}</b>\r\n                </span>\r\n                <div>\r\n                    <span>\r\n                        x <br />\r\n                        {item.count}\r\n                    </span>\r\n                </div>\r\n            </>\r\n        }\r\n    </li>);\r\n    return <div className={classesMiddleWrap['main-cart-modal']} ref={ref}>\r\n        {data.length ?\r\n            <>\r\n                <ul>\r\n                    {_cart}\r\n                </ul>\r\n                <a href=\"/cart\" className={classesMiddleWrap['view-all-cart-btn']} onClick={hideModal}>View All</a>\r\n            </>\r\n            : 'You dont have any added product in your cart yet'}\r\n    </div>\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n    isUser: state.auth.user\r\n});\r\nconst mapDispatchToProps = {\r\n};\r\nexport default connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps\r\n)(MiddleWrap);\r\n"]},"metadata":{},"sourceType":"module"}